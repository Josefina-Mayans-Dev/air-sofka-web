import{c as G}from"./chunk-O3YLKHVU.js";import{a as Y,b as J}from"./chunk-AZNRDLE3.js";import{a as le,c as H}from"./chunk-SRAEFGWB.js";import{a as de}from"./chunk-ISHGJZEF.js";import{B as W,C as K,G as Q,H as s,Ha as te,La as ie,Q as o,U as u,Ua as ne,V as X,Y as f,a as $,aa as O,b as B,ba as F,ca as Z,d as U,da as x,ea as S,f as L,fa as r,g as z,ga as a,ha as g,i as T,j as V,ma as A,na as k,ob as re,q as R,qa as l,ra as c,s as b,sa as ee,ta as j,u as v,ub as ae,vb as oe,x as d,ya as N,yb as se,za as q}from"./chunk-WTVOD2ZT.js";function fe(e,_){if(e&1&&g(0,"lib-route-flight",7),e&2){let t=_.$implicit;f("routeData",t)}}function _e(e,_){if(e&1&&g(0,"lib-flight-card",1),e&2){let t=_.$implicit;f("title",t.title)("date",t.date)("legs",t.legs)("details",t.detail)}}function he(e,_){if(e&1&&(r(0,"p",7),l(1),a()),e&2){let t=k();o(),c(t.email())}}function be(e,_){if(e&1&&(r(0,"p",8),l(1),a()),e&2){let t=k();o(),c(t.phone())}}function Ce(e,_){if(e&1&&(r(0,"p",9),l(1),a()),e&2){let t=k();o(),c(t.type())}}function ve(e,_){if(e&1&&g(0,"lib-resume-passenger-card",2),e&2){let t=_.$implicit;f("name",(t==null?null:t.treatment)+" "+(t==null?null:t.name)+" "+(t==null?null:t.lastName))}}function ye(e,_){if(e&1&&(r(0,"div",4)(1,"span",6),l(2),a(),r(3,"span",7),l(4),N(5,"number"),a()()),e&2){let t=_.$implicit,i=k();o(2),c(t.label),o(2),j("",q(5,3,t.amount,"1.2-2")," ",i.currency(),"")}}var Pe=(()=>{class e{title=s.required();date=s.required();legs=s.required();duration=s("15 h 55 min");operatedBy=s("Air Europa");details=s();static \u0275fac=function(i){return new(i||e)};static \u0275cmp=u({type:e,selectors:[["lib-flight-card"]],inputs:{title:[1,"title"],date:[1,"date"],legs:[1,"legs"],duration:[1,"duration"],operatedBy:[1,"operatedBy"],details:[1,"details"]},decls:13,vars:3,consts:[[1,"flight-card"],[1,"flight-card__header"],[1,"flight-card__title"],[1,"flight-card__date"],[1,"flight-card__separator"],[1,"flight-card__content"],[1,"flight-card__legs"],[3,"routeData"],[1,"flight-card__right"],[3,"detailsData"]],template:function(i,n){i&1&&(r(0,"div",0)(1,"div",1)(2,"h2",2),l(3),a(),r(4,"p",3),l(5),a()(),g(6,"div",4),r(7,"div",5)(8,"div",6),x(9,fe,1,1,"lib-route-flight",7,F),a(),r(11,"div",8),g(12,"lib-detail-flight",9),a()()()),i&2&&(o(3),c(n.title()),o(2),c(n.date()),o(4),S(n.legs()),o(3),f("detailsData",n.details()))},dependencies:[ae,oe],styles:[".flight-card[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #eee;border-radius:12px;padding:24px;width:100%;box-shadow:0 2px 4px #0000000d;margin-bottom:20px}.flight-card__header[_ngcontent-%COMP%]{margin-bottom:8px}.flight-card__title[_ngcontent-%COMP%]{font-size:24px;font-weight:bolder;color:#0d0d0d;margin-bottom:8px}.flight-card__date[_ngcontent-%COMP%]{font-size:12px;color:#0d0d0d}.flight-card__legs[_ngcontent-%COMP%]{margin-bottom:24px;width:70%}.flight-card__duration[_ngcontent-%COMP%], .flight-card__operator[_ngcontent-%COMP%]{margin-bottom:8px}.flight-card__details-link[_ngcontent-%COMP%]{color:#007bff;text-decoration:none;font-weight:700}.flight-card__details-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.flight-card__content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:5%}.flight-card__separator[_ngcontent-%COMP%]{width:100%;height:1px;color:#ccc;margin-bottom:10px;border:1px dashed}"]})}return e})(),xe=(()=>{class e{flights=[];_getFlightSelected=d(H);_getFlight=d(le);constructor(){}ngOnInit(){this._getFlightSelected.initSubscription(),this.getFlightData()}ngOnDestroy(){this._getFlightSelected.destroySubscription()}maptoFlightLegs(t){let i=new Date(t.departure).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),n=new Date(t.arrival).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),C=new Date(t.departure),w=new Date(t.arrival),I=w.getTime()-C.getTime(),h=Math.floor(I/(60*1e3)),P=Math.floor(h/60),m=h%60,y=`${P}h ${m}m`,M=`+${Math.floor((w.getTime()-C.getTime())/(1e3*60*60*24))}`,D={departureTime:i,departureAirportCode:t?.origin,stopAirportCode:t?.destination,stopDuration:"2h35m",arrivalTime:n,arrivalAirportCode:t?.destination,days:M};return{title:"From "+t?.origin+" to "+t?.destination,date:C.toLocaleDateString("en-US",{weekday:"long",day:"2-digit",month:"long",year:"numeric"}),legs:[D],detail:{detail:[`Duration: ${y}`,"Operated by Air-Sofka"],ref:"See itinerary details"}}}getFlightData(){this._getFlightSelected.flight$().pipe(R(t=>this._getFlight.flights$().pipe(T(i=>i.filter(n=>n.id===t.origin.id||n.id===t.destination.id||t.origin.id===t.destination.id&&n.id===t.origin.id)))),b(t=>{this.flights=t.map(i=>this.maptoFlightLegs(i))})).subscribe()}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=u({type:e,selectors:[["lib-flight-card-container"]],decls:4,vars:0,consts:[[1,"title-h1"],[3,"title","date","legs","details"]],template:function(i,n){i&1&&(r(0,"h1",0),l(1,"Your Flight"),a(),x(2,_e,1,4,"lib-flight-card",1,F)),i&2&&(o(2),S(n.flights))},dependencies:[Pe],encapsulation:2})}return e})(),Se=(()=>{class e{icon=s("person");name=s.required();email=s("");phone=s("");type=s("");static \u0275fac=function(i){return new(i||e)};static \u0275cmp=u({type:e,selectors:[["lib-resume-passenger-card"]],inputs:{icon:[1,"icon"],name:[1,"name"],email:[1,"email"],phone:[1,"phone"],type:[1,"type"]},decls:12,vars:4,consts:[[1,"passenger-card"],[1,"passenger-card__details"],[1,"passenger-card__icon"],["width","28","height","28"],[0,"xlink","href","assets/svgs/person-svgrepo-com.svg#person-adult"],[1,"passenger-card__info"],[1,"passenger-card__name"],[1,"passenger-card__email"],[1,"passenger-card__phone"],[1,"passenger-card__type"]],template:function(i,n){i&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"span"),W(),r(4,"svg",3),g(5,"use",4),a()()(),K(),r(6,"div",5)(7,"h3",6),l(8),a(),X(9,he,2,1,"p",7)(10,be,2,1,"p",8)(11,Ce,2,1,"p",9),a()()()),i&2&&(o(8),c(n.name()),o(),O(n.email()?9:-1),o(),O(n.phone()?10:-1),o(),O(n.type()?11:-1))},styles:[".passenger-card[_ngcontent-%COMP%]{margin-top:20px;background-color:#fff;border-radius:8px;padding:16px;box-shadow:0 2px 4px #0000000d;border:1px solid #eee}.passenger-card__details[_ngcontent-%COMP%]{display:flex;align-items:flex-start}.passenger-card__icon[_ngcontent-%COMP%]{margin-right:12px;color:#777;font-size:1.2rem}.passenger-card__info[_ngcontent-%COMP%]{flex-grow:1}.passenger-card__name[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;margin-bottom:4px;color:#333}.passenger-card__email[_ngcontent-%COMP%], .passenger-card__phone[_ngcontent-%COMP%], .passenger-card__type[_ngcontent-%COMP%]{font-size:.875rem;color:#666;margin-bottom:2px}"]})}return e})(),ke=(()=>{class e{_passengerSave=d(J);_passengerContact=d(Y);contactSave$;listPassengers$;passengers=[];contact;ngOnInit(){this._passengerSave.initSubscriptions(),this._passengerContact.initSubscriptions(),this.listPassengers$=this._passengerSave.getListPassengers$(),this.contactSave$=this._passengerContact.passengerContact$(),this.getPassengers()}getPassengers(){this._passengerSave.getListPassengers$().pipe(T(t=>t.map(i=>{this.passengers.push(i)}))).subscribe(),this._passengerContact.passengerContact$().pipe(T(t=>{this.contact=t})).subscribe()}ngOnDestroy(){this._passengerSave.destroySubscriptions(),this._passengerContact.destroySubscriptions()}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=u({type:e,selectors:[["lib-passenger-card-container"]],decls:5,vars:3,consts:[[1,"title-h1"],["type","Adult",3,"name","email","phone"],[3,"name","email","phone","type"]],template:function(i,n){i&1&&(r(0,"h1",0),l(1,"Passenger"),a(),g(2,"lib-resume-passenger-card",1),x(3,ve,1,1,"lib-resume-passenger-card",2,F)),i&2&&(o(2),f("name",(n.passengers[0]==null?null:n.passengers[0].treatment)+" "+(n.passengers[0]==null?null:n.passengers[0].name)+" "+(n.passengers[0]==null?null:n.passengers[0].lastName))("email",n.contact==null?null:n.contact.email)("phone",(n.contact==null?null:n.contact.prefix)+" "+(n.contact==null?null:n.contact.telephoneNumber)),o(),S(n.passengers))},dependencies:[Se],encapsulation:2})}return e})(),we=(()=>{class e{title=s("Price breakdown");totalPrice=s.required();currency=s("USD");details=s([]);static \u0275fac=function(i){return new(i||e)};static \u0275cmp=u({type:e,selectors:[["lib-price-breakdown-card"]],inputs:{title:[1,"title"],totalPrice:[1,"totalPrice"],currency:[1,"currency"],details:[1,"details"]},decls:13,vars:6,consts:[[1,"price-breakdown"],[1,"price-breakdown__title"],[1,"price-breakdown__separator"],[1,"price-breakdown__details"],[1,"price-breakdown__item"],[1,"price-breakdown__total"],[1,"price-breakdown__label"],[1,"price-breakdown__amount"]],template:function(i,n){i&1&&(r(0,"div",0)(1,"h2",1),l(2),a(),g(3,"div",2),r(4,"div",3),x(5,ye,6,6,"div",4,Z),a(),r(7,"div",5)(8,"span",6),l(9,"Total Price"),a(),r(10,"span",7),l(11),N(12,"number"),a()()()),i&2&&(o(2),c(n.title()),o(3),S(n.details()),o(6),j("",q(12,3,n.totalPrice(),"1.2-2")," ",n.currency(),""))},dependencies:[te],styles:[".price-breakdown[_ngcontent-%COMP%]{margin-top:20px;background-color:#fff;border:1px solid #eee;border-radius:8px;padding:16px;font-family:sans-serif}.price-breakdown__title[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;margin-bottom:16px;color:#333}.price-breakdown__details[_ngcontent-%COMP%]{margin-bottom:16px}.price-breakdown__item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #eee}.price-breakdown__item[_ngcontent-%COMP%]:last-child{border-bottom:none}.price-breakdown__label[_ngcontent-%COMP%]{color:#555;font-size:.9rem}.price-breakdown__amount[_ngcontent-%COMP%]{font-weight:700;color:#333;font-size:.9rem}.price-breakdown__total[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding-top:16px;font-weight:700;border-top:1px solid #eee;color:#007bff}.price-breakdown__separator[_ngcontent-%COMP%]{width:100%;height:1px;color:#ccc;margin-bottom:10px;border:1px dashed}"]})}return e})(),Me=(()=>{class e{state(t){return{$:()=>t.asObservable(),snapshot:()=>this.immutabilize(t.getValue()),set:i=>t.next(this.immutabilize(i))}}immutabilize(t){return JSON.parse(JSON.stringify(t))}static \u0275fac=function(i){return new(i||e)};static \u0275prov=v({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),De=(()=>{class e{_factory=d(Me);costBreakdown$=new L(null);booking$=new L(null);store(){return{costBreakdown:this._factory.state(this.costBreakdown$),booking:this._factory.state(this.booking$)}}static \u0275fac=function(i){return new(i||e)};static \u0275prov=v({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),ce=(()=>{class e{_booking=d(De);get booking(){return this._booking.store()}static \u0275fac=function(i){return new(i||e)};static \u0275prov=v({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),pe=(()=>{class e{mainUrl="http://localhost:8080/booking";http=d(ie);getCostBreakdown(t){return this.http.post(`${this.mainUrl}/cost`,t)}makeBooking(t){return this.http.post(`${this.mainUrl}`,t)}static \u0275fac=function(i){return new(i||e)};static \u0275prov=v({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),ge=(()=>{class e{_service=d(pe);_state=d(ce);subscriptions;constBreadown$(){return this._state.booking.costBreakdown.$()}initSubscriptions(){this.subscriptions=new U}destroySubscriptions(){this.subscriptions.unsubscribe()}execute(t){let i=localStorage.getItem("id");this.subscriptions.add(this._service.getCostBreakdown(B($({},t),{userId:i})).pipe(b({next:n=>{this._state.booking.costBreakdown.set(n)},error:n=>{console.error("Error getting cost breakdown:",n)}})).subscribe())}static \u0275fac=function(i){return new(i||e)};static \u0275prov=v({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Te=(()=>{class e{_selectedSeatsUsecase=d(G);_getCostBreakdown=d(ge);listSeatsIds;seatsIds=[];priceDetails=[];totalPrice=0;currency="USD";ngOnInit(){this._selectedSeatsUsecase.initSubscriptions(),this._getCostBreakdown.initSubscriptions(),this.getSeatsIds()}ngOnDestroy(){this._getCostBreakdown.destroySubscriptions(),this._selectedSeatsUsecase.destroySubscriptions()}getSeatsIds(){this._selectedSeatsUsecase.selectedSeatsId$().pipe(b(t=>this.seatsIds=t),b(()=>{this.getCostBreakdown()})).subscribe()}getCostBreakdown(){this._getCostBreakdown.execute({passengers:this.seatsIds.map(t=>({seatId:t})),userId:null}),this._getCostBreakdown.constBreadown$().pipe(b(t=>{t?this.updatePriceDetails(t):console.error("No cost breakdown found in state")})).subscribe()}updatePriceDetails(t){this.priceDetails=[{label:"Ticket Price",amount:t.ticketPrice},{label:"Airport Tax",amount:t.airportTax},{label:"Booking Fee",amount:t.bookingFee},{label:"Fuel Insurance",amount:t.fuelInsurance},{label:"Additional Charges",amount:t.additionalCharges},{label:"Discount",amount:t.discount}],this.totalPrice=t.totalAmount}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=u({type:e,selectors:[["lib-price-breakdown-container"]],decls:3,vars:3,consts:[[1,"title-h1"],[3,"totalPrice","currency","details"]],template:function(i,n){i&1&&(r(0,"h1",0),l(1,"Price Breakdown"),a(),g(2,"lib-price-breakdown-card",1)),i&2&&(o(2),f("totalPrice",n.totalPrice)("currency",n.currency)("details",n.priceDetails))},dependencies:[we],encapsulation:2})}return e})(),Oe=(()=>{class e{segmentLabel=s("");date=s("");flight=s({origin:"",originTime:"",destination:"",destinationTime:""});static \u0275fac=function(i){return new(i||e)};static \u0275cmp=u({type:e,selectors:[["lib-flight-detail"]],inputs:{segmentLabel:[1,"segmentLabel"],date:[1,"date"],flight:[1,"flight"]},decls:19,vars:6,consts:[[1,"flight-detail"],[1,"flight-detail__header"],[1,"flight-detail__label"],[1,"flight-detail__date"],[1,"flight-detail__times"],[1,"flight-detail__time"],[1,"flight-detail__airport"],[1,"flight-detail__time-value"],[1,"flight-detail__arrow"]],template:function(i,n){i&1&&(r(0,"div",0)(1,"div",1)(2,"span",2),l(3),a(),r(4,"span",3),l(5),a()(),r(6,"div",4)(7,"div",5)(8,"span",6),l(9),a(),r(10,"span",7),l(11),a()(),r(12,"div",8),g(13,"hr"),a(),r(14,"div",5)(15,"span",6),l(16),a(),r(17,"span",7),l(18),a()()()()),i&2&&(o(3),c(n.segmentLabel()),o(2),c(n.date()),o(4),c(n.flight().origin),o(2),c(n.flight().originTime),o(5),c(n.flight().destination),o(2),c(n.flight().destinationTime))},styles:[".flight-detail[_ngcontent-%COMP%]{padding:16px}.flight-detail__header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem;font-size:.875rem}.flight-detail__label[_ngcontent-%COMP%]{font-weight:700}.flight-detail__date[_ngcontent-%COMP%]{color:#6b7280}.flight-detail__times[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center}.flight-detail__time[_ngcontent-%COMP%]{text-align:center}.flight-detail__airport[_ngcontent-%COMP%]{font-weight:700;display:block}.flight-detail__time-value[_ngcontent-%COMP%]{display:block;font-size:1rem}.flight-detail__arrow[_ngcontent-%COMP%]{flex-grow:1;display:flex;align-items:center}.flight-detail__arrow[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{border:none;border-top:1px solid #9ca3af;width:100%}"]})}return e})(),Fe=(()=>{class e{label=s("");price=s(0);static \u0275fac=function(i){return new(i||e)};static \u0275cmp=u({type:e,selectors:[["lib-price-row"]],inputs:{label:[1,"label"],price:[1,"price"]},decls:5,vars:2,consts:[[1,"price-row"],[1,"price-row__label"],[1,"price-row__price"]],template:function(i,n){i&1&&(r(0,"div",0)(1,"span",1),l(2),a(),r(3,"span",2),l(4),a()()),i&2&&(o(2),c(n.label()),o(2),c(n.price()))},styles:[".price-row[_ngcontent-%COMP%]{padding-left:16px;padding-right:16px;display:flex;justify-content:space-between;align-items:center;margin-bottom:.25rem}.price-row__label[_ngcontent-%COMP%], .price-row__price[_ngcontent-%COMP%]{font-size:1rem}"]})}return e})(),Ie=(()=>{class e{totalPrice=s(0);static \u0275fac=function(i){return new(i||e)};static \u0275cmp=u({type:e,selectors:[["lib-total-price"]],inputs:{totalPrice:[1,"totalPrice"]},decls:5,vars:1,consts:[[1,"total-price"],[1,"total-price__label"],[1,"total-price__price"]],template:function(i,n){i&1&&(r(0,"div",0)(1,"span",1),l(2,"Total price:"),a(),r(3,"span",2),l(4),a()()),i&2&&(o(4),ee("",n.totalPrice()," USD"))},styles:[".total-price[_ngcontent-%COMP%]{background-color:#1e3a8a;color:#fff;padding:.75rem;display:flex;justify-content:space-between;align-items:center}.total-price__label[_ngcontent-%COMP%]{font-weight:700;font-size:1.125rem}.total-price__price[_ngcontent-%COMP%]{font-size:1.125rem}"]})}return e})(),Ee=(()=>{class e{title=s("Flight Resume");departureDate=s("");returnDate=s("");outboundFlight=s({origin:"",originTime:"",destination:"",destinationTime:""});returnFlight=s({origin:"",originTime:"",destination:"",destinationTime:""});flightPrice=s(0);adultTicketPrice=s(0);totalPrice=s(0);disclaimerText=s("");passengers=s(0);confirmClicked=Q();onConfirmClick(){this.confirmClicked.emit()}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=u({type:e,selectors:[["lib-resume-card"]],inputs:{title:[1,"title"],departureDate:[1,"departureDate"],returnDate:[1,"returnDate"],outboundFlight:[1,"outboundFlight"],returnFlight:[1,"returnFlight"],flightPrice:[1,"flightPrice"],adultTicketPrice:[1,"adultTicketPrice"],totalPrice:[1,"totalPrice"],disclaimerText:[1,"disclaimerText"],passengers:[1,"passengers"]},outputs:{confirmClicked:"confirmClicked"},decls:19,vars:12,consts:[[1,"flight"],[1,"flight__header"],[1,"flight__title"],[1,"flight__flight-segment"],[3,"segmentLabel","date","flight"],[1,"flight__prices"],["label","Flights",3,"price"],[3,"label","price"],[1,"flight__total"],[3,"totalPrice"],[1,"flight__disclaimer"],[2,"padding","16px"],[1,"flight__button",3,"click"]],template:function(i,n){i&1&&(r(0,"div",0)(1,"section",1)(2,"h2",2),l(3),a()(),r(4,"div",3),g(5,"lib-flight-detail",4),a(),r(6,"div",3),g(7,"lib-flight-detail",4),a(),r(8,"div",5),g(9,"lib-price-row",6)(10,"lib-price-row",7),a(),r(11,"div",8),g(12,"lib-total-price",9),a(),r(13,"div",10)(14,"span"),l(15),a()(),r(16,"div",11)(17,"button",12),A("click",function(){return n.onConfirmClick()}),l(18,"Continuar"),a()()()),i&2&&(o(3),c(n.title()),o(2),f("segmentLabel","Go to")("date",n.departureDate())("flight",n.outboundFlight()),o(2),f("segmentLabel","Return")("date",n.returnDate())("flight",n.returnFlight()),o(2),f("price",n.flightPrice()),o(),f("label",n.passengers()+" Adult")("price",n.adultTicketPrice()),o(2),f("totalPrice",n.totalPrice()),o(3),c(n.disclaimerText()))},dependencies:[Oe,Fe,Ie],styles:[".flight[_ngcontent-%COMP%]{max-width:300px;border-radius:10px;background-color:#fff;box-shadow:0 2px 4px #0000001a;font-family:sans-serif;color:#1e293b}.flight__header[_ngcontent-%COMP%]{background-color:#3b82f6;color:#fff;padding:10px;border-radius:10px 10px 0 0;margin-bottom:10px}.flight__title[_ngcontent-%COMP%]{font-size:1.25rem;margin:0;font-weight:500;text-align:center}.flight__flight-segment[_ngcontent-%COMP%], .flight__prices[_ngcontent-%COMP%], .flight__total[_ngcontent-%COMP%]{margin-bottom:1rem}.flight__disclaimer[_ngcontent-%COMP%]{font-size:1rem;color:#6b7280;text-align:center;padding:10px}.flight__button[_ngcontent-%COMP%]{background-color:#9f21d3;color:#fff;border:none;padding:.75rem 1.5rem;border-radius:10px;cursor:pointer;font-size:1rem;display:block;width:100%;text-align:center}.flight__button[_ngcontent-%COMP%]:hover{background-color:#7c0ea5}"]})}return e})(),$e=(()=>{class e{_service=d(pe);_state=d(ce);_router=d(ne);subscriptions;booking$(){return this._state.booking.booking.$()}initSubscriptions(){this.subscriptions=new U}destroySubscriptions(){this.subscriptions.unsubscribe()}execute(t){let i=localStorage.getItem("id");this.subscriptions.add(this._service.makeBooking(B($({},t),{userId:i})).pipe(b({next:n=>{this._state.booking.booking.set(n),this._router.navigate([""])},error:n=>{console.error("Error getting cost breakdown:",n)}})).subscribe())}static \u0275fac=function(i){return new(i||e)};static \u0275prov=v({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Be=(()=>{class e{_passengerSave=d(J);_passengerContact=d(Y);_selectedSeatsUsecase=d(G);_getCostBreakdown=d(ge);_getFlightSelected=d(H);_createBookingUseCase=d($e);_createPay=d(de);contactSave$;listPassengers$;selectedSeatsId$;request;flightSumary={title:"Flight summary",departureDate:"",returnDate:"",outboundFlight:{origin:"",originTime:"",destination:"",destinationTime:""},returnFlight:{origin:"",originTime:"",destination:"",destinationTime:""},flightPrice:0,adultTicketPrice:0,totalPrice:0,disclaimerText:"Taxes, surcharges and discounts are included in the final price.",passengers:0};onContinue(){this._createBookingUseCase.execute(this.request)}ngOnInit(){this._passengerSave.initSubscriptions(),this._passengerContact.initSubscriptions(),this._selectedSeatsUsecase.initSubscriptions(),this._getCostBreakdown.initSubscriptions(),this._getFlightSelected.initSubscription(),this._createPay.initSubscriptions(),this._createBookingUseCase.initSubscriptions(),this.buildBookingRequest()}ngOnDestroy(){this._passengerSave.destroySubscriptions(),this._passengerContact.destroySubscriptions(),this._selectedSeatsUsecase.destroySubscriptions(),this._getCostBreakdown.destroySubscriptions(),this._getFlightSelected.destroySubscription(),this._createBookingUseCase.destroySubscriptions(),this._createPay.destroySubscriptions()}buildBookingRequest(){let t=this._passengerSave.getListPassengers$(),i=this._selectedSeatsUsecase.selectedSeatsId$(),n=this._getCostBreakdown.constBreadown$(),C=this._passengerContact.passengerContact$(),w=this._getFlightSelected.flight$(),I=this._createPay.getMethodPay$();V([t,i,n,C,w,I]).pipe(R(([h,P,m,y,p,M])=>{if(!h||!P||!m||!y||!h.length||!P.length||!p||!M)return z(null);let D=h.map((E,ue)=>({passengerTitle:E?.treatment,passengerName:E?.name,passengerLastName:E?.lastName,passengerType:"ADULT",seatId:P[ue]||null}));this.flightSumary={title:"Flight summary",departureDate:p?.origin.departure,returnDate:p?.origin.arrival,outboundFlight:{origin:p?.origin.origin,originTime:p?.origin.departure,destination:p?.origin.destination,destinationTime:p?.origin.arrival},returnFlight:{origin:p?.destination.origin,originTime:p?.destination.departure,destination:p?.destination.destination,destinationTime:p?.destination.arrival},flightPrice:m?.totalAmount,adultTicketPrice:m?.ticketPrice,totalPrice:m?.totalAmount,disclaimerText:"Taxes, surcharges and discounts are included in the final price.",passengers:D.length};let me={bookingStatus:"CONFIRMED",bookingPrice:m?.ticketPrice,discount:m?.discount,flightId:p?.origin.id,userId:null,paymentMethod:M,email:y?.email,prefix:y?.prefix,phoneNumber:y?.telephoneNumber,departureCity:p?.origin.origin,arrivalCity:p?.origin.destination,departureDate:p?.origin.departure,arrivalDate:p?.origin.arrival,airportTax:m?.airportTax,additionalCharges:m?.additionalCharges,fuelInsurance:m?.fuelInsurance,bookingFee:m?.bookingFee,totalAmount:m?.totalAmount,ticketPrice:m?.ticketPrice,keyNotes:"Hold you things  pls",passengers:D};return z(me)}),b(h=>{h&&(this.request=h)})).subscribe()}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=u({type:e,selectors:[["lib-resume-card-container"]],decls:1,vars:10,consts:[[3,"confirmClicked","title","departureDate","returnDate","outboundFlight","returnFlight","flightPrice","adultTicketPrice","totalPrice","passengers","disclaimerText"]],template:function(i,n){i&1&&(r(0,"lib-resume-card",0),A("confirmClicked",function(){return n.onContinue()}),a()),i&2&&f("title",n.flightSumary.title)("departureDate",n.flightSumary.departureDate)("returnDate",n.flightSumary.returnDate)("outboundFlight",n.flightSumary.outboundFlight)("returnFlight",n.flightSumary.returnFlight)("flightPrice",n.flightSumary.flightPrice)("adultTicketPrice",n.flightSumary.adultTicketPrice)("totalPrice",n.flightSumary.totalPrice)("passengers",n.flightSumary.passengers)("disclaimerText",n.flightSumary.disclaimerText)},dependencies:[Ee],encapsulation:2})}return e})(),Ue=(()=>{class e{_bookingHeaderService=d(re);ngOnInit(){this._bookingHeaderService.sendBookingHeader({title:"Booking",subtitle:"Make your reservation here"})}onDetailsClick(){}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=u({type:e,selectors:[["lib-booking-resume-layout"]],decls:7,vars:0,consts:[[1,"booking-resume-layout"],[1,"booking-resume-layout__flights"],[1,"booking-resume-layout__resume"]],template:function(i,n){i&1&&(r(0,"section",0)(1,"div",1),g(2,"lib-flight-card-container")(3,"lib-passenger-card-container")(4,"lib-price-breakdown-container"),a(),r(5,"div",2),g(6,"lib-resume-card-container"),a()())},dependencies:[xe,ke,Te,Be],styles:[".booking-resume-layout[_ngcontent-%COMP%]{background-color:#f8f9fa;display:flex;margin:0 auto;width:930px;padding-top:20px}.booking-resume-layout__flights[_ngcontent-%COMP%]{width:70%;padding-right:20px}.booking-resume-layout__resume[_ngcontent-%COMP%]{width:30%;position:sticky;top:17%;height:fit-content}"]})}return e})(),Ke=[{path:"",component:se,children:[{path:"",component:Ue}]}];export{Ke as bookingRoutes};
